if(typeof Baze!=='undefined'){Baze.provide("system.jext");}function $(element){if(arguments.length>1){for(var i=0,elements=[],length=arguments.length;i<length;i++)elements.push($(arguments[i]));return elements;}if(typeof element=='string')element=document.getElementById(element);return element;}var Prototype={Version:'1.5.0',BrowserFeatures:{XPath:!!document.evaluate},ScriptFragment:'(?:<script.*?>)((\n|\r|.)*?)(?:<\/script>)',emptyFunction:function(){},K:function(x){return x}};var Class={create:function(){return function(){this.initialize.apply(this,arguments);}}};var Try={these:function(){var returnValue;for(var i=0,length=arguments.length;i<length;i++){var lambda=arguments[i];try{returnValue=lambda();break;}catch(e){}}return returnValue;}};Object.extend=function extend(destination,source){for(property in source){destination[property]=source[property];}return destination;};Object.clone=function clone(object){return Object.extend({},object);};Object.extend(String.prototype,{isUpperCased:function(){return(this.match(/[a-z]/)==null);},isLowerCased:function(){return(this.match(/[A-Z]/)==null);},trim:function(){return(this.replace(/^\s+|\s+$/gi,"").replace(/\s{2,}/gi," "));},capitalize:function(){return this.charAt(0).toUpperCase()+this.substring(1);},toQueryParams:function(separator){var match=this.strip().match(/([^?#]*)(#.*)?$/);if(!match)return{};return match[1].split(separator||'&').inject({},function(hash,pair){if((pair=pair.split('='))[0]){var name=decodeURIComponent(pair[0]);var value=pair[1]?decodeURIComponent(pair[1]):undefined;if(hash[name]!==undefined){if(hash[name].constructor!=Array)hash[name]=[hash[name]];if(value)hash[name].push(value);}else hash[name]=value;}return hash;});},strip:function(){return this.replace(/^\s+/,'').replace(/\s+$/,'');},stripTags:function(){return this.replace(/<\/?[^>]+>/gi,'');},stripScripts:function(){return this.replace(new RegExp(Prototype.ScriptFragment,'img'),'');}});Object.extend(Array.prototype,{init:function(zero){if(typeof zero=="undefined")zero=null;for(var i=0;i<this.length;i++)this[i]=zero;}});var $break=new Object();var $continue=new Object();var Enumerable={each:function(iterator){var index=0;try{this._each(function(value){try{iterator(value,index++);}catch(e){if(e!=$continue)throw e;}});}catch(e){if(e!=$break)throw e;}return this;},eachSlice:function(number,iterator){var index=-number,slices=[],array=this.toArray();while((index+=number)<array.length)slices.push(array.slice(index,index+number));return slices.map(iterator);},all:function(iterator){var result=true;this.each(function(value,index){result=result&&!!(iterator||Prototype.K)(value,index);if(!result)throw $break;});return result;},any:function(iterator){var result=false;this.each(function(value,index){if(result=!!(iterator||Prototype.K)(value,index))throw $break;});return result;},collect:function(iterator){var results=[];this.each(function(value,index){results.push((iterator||Prototype.K)(value,index));});return results;},detect:function(iterator){var result;this.each(function(value,index){if(iterator(value,index)){result=value;throw $break;}});return result;},findAll:function(iterator){var results=[];this.each(function(value,index){if(iterator(value,index))results.push(value);});return results;},grep:function(pattern,iterator){var results=[];this.each(function(value,index){var stringValue=value.toString();if(stringValue.match(pattern))results.push((iterator||Prototype.K)(value,index));});return results;},include:function(object){var found=false;this.each(function(value){if(value==object){found=true;throw $break;}});return found;},inGroupsOf:function(number,fillWith){fillWith=fillWith===undefined?null:fillWith;return this.eachSlice(number,function(slice){while(slice.length<number)slice.push(fillWith);return slice;});},inject:function(memo,iterator){this.each(function(value,index){memo=iterator(memo,value,index);});return memo;},invoke:function(method){var args=$A(arguments).slice(1);return this.map(function(value){return value[method].apply(value,args);});},max:function(iterator){var result;this.each(function(value,index){value=(iterator||Prototype.K)(value,index);if(result==undefined||value>=result)result=value;});return result;},min:function(iterator){var result;this.each(function(value,index){value=(iterator||Prototype.K)(value,index);if(result==undefined||value<result)result=value;});return result;},partition:function(iterator){var trues=[],falses=[];this.each(function(value,index){((iterator||Prototype.K)(value,index)?trues:falses).push(value);});return[trues,falses];},pluck:function(property){var results=[];this.each(function(value,index){results.push(value[property]);});return results;},reject:function(iterator){var results=[];this.each(function(value,index){if(!iterator(value,index))results.push(value);});return results;},sortBy:function(iterator){return this.map(function(value,index){return{value:value,criteria:iterator(value,index)};}).sort(function(left,right){var a=left.criteria,b=right.criteria;return a<b?-1:a>b?1:0;}).pluck('value');},toArray:function(){return this.map();},zip:function(){var iterator=Prototype.K,args=$A(arguments);if(typeof args.last()=='function')iterator=args.pop();var collections=[this].concat(args).map($A);return this.map(function(value,index){return iterator(collections.pluck(index));});},size:function(){return this.toArray().length;},inspect:function(){return'#<Enumerable:'+this.toArray().inspect()+'>';}};Object.extend(Enumerable,{map:Enumerable.collect,find:Enumerable.detect,select:Enumerable.findAll,member:Enumerable.include,entries:Enumerable.toArray});Object.extend(Array.prototype,Enumerable);if(!Array.prototype._reverse)Array.prototype._reverse=Array.prototype.reverse;Object.extend(Array.prototype,{_each:function(iterator){for(var i=0,length=this.length;i<length;i++)iterator(this[i]);},clear:function(){this.length=0;return this;},first:function(){return this[0];},last:function(){return this[this.length-1];},compact:function(){return this.select(function(value){return value!=null;});},flatten:function(){return this.inject([],function(array,value){return array.concat(value&&value.constructor==Array?value.flatten():[value]);});},without:function(){var values=$A(arguments);return this.select(function(value){return!values.include(value);});},indexOf:function(object){for(var i=0,length=this.length;i<length;i++)if(this[i]==object)return i;return -1;},reverse:function(inline){return(inline!==false?this:this.toArray())._reverse();},reduce:function(){return this.length>1?this:this[0];},uniq:function(){return this.inject([],function(array,value){return array.include(value)?array:array.concat([value]);});},clone:function(){return[].concat(this);},size:function(){return this.length;},inspect:function(){return'['+this.map(Object.inspect).join(', ')+']';}});if(typeof Node=="undefined"){var __IEcreateElement=document.createElement;document.createElement=function(tagName){var element=__IEcreateElement(tagName);var interf=new Element;Object.extend(element,interf);return element;};}if(typeof Element=="undefined"){Element=new Function;}Object.extend(Element.prototype,{contains:function(element){if(this.childNodes.length>0){for(var child=0;child<this.childNodes.length;child++){if(this.childNodes[child]===element){return true;}else if(this.childNodes[child].contains(element)){return true;}}}return false;},isDescendentOf:function(element){return element.contains(this);},compareTo:function(element,attExcept,attValue){if(this.childNodes.length!=element.childNodes.length){return false;}if(this.attributes.length!=element.attributes.length){return false;}for(var att=0;att<this.attributes.length;att++){if(this.attributes[att].name.toLowerCase()!=element.attributes[att].name.toLowerCase()||this.attributes[att].value!=element.attributes[att].value){return false;}}for(var child=0;child<this.childNodes.length;child++){if(this.childNodes[child].nodeType==1&&element.childNodes[child].nodeType==1){var attExclude=this.childNodes[child].getAttribute(attExcept);if(attExclude==attValue){continue;}if(this.childNodes[child].value!=element.childNodes[child].value){return false;}if(this.childNodes[child].compareTo(element.childNodes[child],attExcept)==false){return false;}}else if(this.childNodes[child].value!=element.childNodes[child].value){return false;}}return true;},visible:function(element){return $(element).style.display!='none';},toggle:function(){for(var i=0;i<arguments.length;i++){var element=$(arguments[i]);Element[Element.visible(element)?'hide':'show'](element);}},hide:function(){for(var i=0;i<arguments.length;i++){if(arguments[i].isArray&&arguments[i].isArray()){for(var j=0;j<arguments[i].length;j++){var element=$(arguments[i][j]);if(!element)continue;element.style.display='none';}}else{var element=$(arguments[i]);if(!element)continue;element.style.display='none';}}},show:function(){for(var i=0;i<arguments.length;i++){if(arguments[i].isArray&&arguments[i].isArray()){for(var j=0;j<arguments[i].length;j++){var element=$(arguments[i][j]);if(!element)continue;element.style.display='';}}else{var element=$(arguments[i]);if(!element)continue;element.style.display='';}}}});var $A=Array.from=function(iterable){if(!iterable)return[];if(iterable.toArray){return iterable.toArray();}else{var results=[];for(var i=0,length=iterable.length;i<length;i++)results.push(iterable[i]);return results;}};Function.prototype.bind=function(){var __method=this,args=$A(arguments),object=args.shift();return function(){return __method.apply(object,args.concat($A(arguments)));}};Function.prototype.bindAsEventListener=function(object){var __method=this,args=$A(arguments),object=args.shift();return function(event){return __method.apply(object,[event||window.event].concat(args));}};if(typeof Baze!="undefined"){Baze.provide("system.Ajax");}var Ajax={getTransport:function(){return Try.these(function(){return new XMLHttpRequest();},function(){return new ActiveXObject('Msxml2.XMLHTTP');},function(){return new ActiveXObject('Microsoft.XMLHTTP');})||false;},activeRequestCount:0};Ajax.Responders={responders:[],_each:function(iterator){this.responders._each(iterator);},register:function(responder){if(!this.include(responder))this.responders.push(responder);},unregister:function(responder){this.responders=this.responders.without(responder);},dispatch:function(callback,request,transport,json){this.each(function(responder){if(typeof responder[callback]=='function'){try{responder[callback].apply(responder,[request,transport,json]);}catch(e){}}});}};Object.extend(Ajax.Responders,Enumerable);Ajax.Responders.register({onCreate:function(){Ajax.activeRequestCount++;},onComplete:function(){Ajax.activeRequestCount--;}});Ajax.Baze=function(){};Ajax.Baze.prototype={setOptions:function(options){this.options={method:'post',asynchronous:true,contentType:'application/x-www-form-urlencoded',encoding:'UTF-8',parameters:''};Object.extend(this.options,options||{});this.options.method=this.options.method.toLowerCase();if(typeof this.options.parameters=='string')this.options.parameters=this.options.parameters.toQueryParams();}};Ajax.Request=Class.create();Ajax.Request.Events=['Uninitialized','Loading','Loaded','Interactive','Complete'];Ajax.Request.prototype=Object.extend(new Ajax.Baze(),{_complete:false,initialize:function(url,options){this.transport=Ajax.getTransport();this.setOptions(options);this.request(url);},request:function(url){this.url=url;this.method=this.options.method;var params=this.options.parameters;if(!['get','post'].include(this.method)){params['_method']=this.method;this.method='post';}params=Hash.toQueryString(params);if(params&&/Konqueror|Safari|KHTML/.test(navigator.userAgent))params+='&_=';if(this.method=='get'&&params)this.url+=(this.url.indexOf('?')>-1?'&':'?')+params;try{Ajax.Responders.dispatch('onCreate',this,this.transport);this.transport.open(this.method.toUpperCase(),this.url,this.options.asynchronous);if(this.options.asynchronous)setTimeout((function(){this.respondToReadyState(1);}).bind(this),10);this.transport.onreadystatechange=this.onStateChange.bind(this);this.setRequestHeaders();var body=this.method=='post'?(this.options.postBody||params):null;this.transport.send(body);if(!this.options.asynchronous&&this.transport.overrideMimeType)this.onStateChange();}catch(e){this.dispatchException(e);}},onStateChange:function(){var readyState=this.transport.readyState;if(readyState>1&&!((readyState==4)&&this._complete))this.respondToReadyState(this.transport.readyState);},setRequestHeaders:function(){var headers={'X-Requested-With':'XMLHttpRequest','X-Prototype-Version':Prototype.Version,'Accept':'text/javascript, text/html, application/xml, text/xml, */*'};if(this.method=='post'){headers['Content-type']=this.options.contentType+(this.options.encoding?'; charset='+this.options.encoding:'');if(this.transport.overrideMimeType&&(navigator.userAgent.match(/Gecko\/(\d{4})/)||[0,2005])[1]<2005)headers['Connection']='close';}if(typeof this.options.requestHeaders=='object'){var extras=this.options.requestHeaders;if(typeof extras.push=='function')for(var i=0,length=extras.length;i<length;i+=2)headers[extras[i]]=extras[i+1];else $H(extras).each(function(pair){headers[pair.key]=pair.value});}for(var name in headers)this.transport.setRequestHeader(name,headers[name]);},success:function(){return!this.transport.status||(this.transport.status>=200&&this.transport.status<300);},respondToReadyState:function(readyState){var state=Ajax.Request.Events[readyState];var transport=this.transport,json=this.evalJSON();if(state=='Complete'){try{this._complete=true;(this.options['on'+this.transport.status]||this.options['on'+(this.success()?'Success':'Failure')]||Prototype.emptyFunction)(transport,json);}catch(e){this.dispatchException(e);}if((this.getHeader('Content-type')||'text/javascript').strip().match(/^(text|application)\/(x-)?(java|ecma)script(;.*)?$/i))this.evalResponse();}try{(this.options['on'+state]||Prototype.emptyFunction)(transport,json);Ajax.Responders.dispatch('on'+state,this,transport,json);}catch(e){this.dispatchException(e);}if(state=='Complete'){this.transport.onreadystatechange=Prototype.emptyFunction;}},getHeader:function(name){try{return this.transport.getResponseHeader(name);}catch(e){return null}},evalJSON:function(){try{var json=this.getHeader('X-JSON');return json?eval('('+json+')'):null;}catch(e){return null}},evalResponse:function(){try{return eval(this.transport.responseText);}catch(e){this.dispatchException(e);}},dispatchException:function(exception){(this.options.onException||Prototype.emptyFunction)(this,exception);Ajax.Responders.dispatch('onException',this,exception);}});Ajax.Updater=Class.create();Object.extend(Object.extend(Ajax.Updater.prototype,Ajax.Request.prototype),{initialize:function(container,url,options){this.container={success:(container.success||container),failure:(container.failure||(container.success?null:container))};this.transport=Ajax.getTransport();this.setOptions(options);var onComplete=this.options.onComplete||Prototype.emptyFunction;this.options.onComplete=(function(transport,param){this.updateContent();onComplete(transport,param);}).bind(this);this.request(url);},updateContent:function(){var receiver=this.container[this.success()?'success':'failure'];var response=this.transport.responseText;if(!this.options.evalScripts)response=response.stripScripts();if(receiver=$(receiver)){if(this.options.insertion)new this.options.insertion(receiver,response);else receiver.update(response);}if(this.success()){if(this.onComplete)setTimeout(this.onComplete.bind(this),10);}}});Ajax.PeriodicalUpdater=Class.create();Ajax.PeriodicalUpdater.prototype=Object.extend(new Ajax.Baze(),{initialize:function(container,url,options){this.setOptions(options);this.onComplete=this.options.onComplete;this.frequency=(this.options.frequency||2);this.decay=(this.options.decay||1);this.updater={};this.container=container;this.url=url;this.start();},start:function(){this.options.onComplete=this.updateComplete.bind(this);this.onTimerEvent();},stop:function(){this.updater.options.onComplete=undefined;clearTimeout(this.timer);(this.onComplete||Prototype.emptyFunction).apply(this,arguments);},updateComplete:function(request){if(this.options.decay){this.decay=(request.responseText==this.lastText?this.decay*this.options.decay:1);this.lastText=request.responseText;}this.timer=setTimeout(this.onTimerEvent.bind(this),this.decay*this.frequency*1000);},onTimerEvent:function(){this.updater=new Ajax.Updater(this.container,this.url,this.options);}});var Hash=function(obj){Object.extend(this,obj||{});};Object.extend(Hash,{toQueryString:function(obj){var parts=[];this.prototype._each.call(obj,function(pair){if(!pair.key)return;if(pair.value&&pair.value.constructor==Array){var values=pair.value.compact();if(values.length<2)pair.value=values.reduce();else{key=encodeURIComponent(pair.key);values.each(function(value){value=value!=undefined?encodeURIComponent(value):'';parts.push(key+'='+encodeURIComponent(value));});return;}}if(pair.value==undefined)pair[1]='';parts.push(pair.map(encodeURIComponent).join('='));});return parts.join('&');}});Object.extend(Hash.prototype,Enumerable);Object.extend(Hash.prototype,{_each:function(iterator){for(var key in this){var value=this[key];if(value&&value==Hash.prototype[key])continue;var pair=[key,value];pair.key=key;pair.value=value;iterator(pair);}},keys:function(){return this.pluck('key');},values:function(){return this.pluck('value');},merge:function(hash){return $H(hash).inject(this,function(mergedHash,pair){mergedHash[pair.key]=pair.value;return mergedHash;});},remove:function(){var result;for(var i=0,length=arguments.length;i<length;i++){var value=this[arguments[i]];if(value!==undefined){if(result===undefined)result=value;else{if(result.constructor!=Array)result=[result];result.push(value);}}delete this[arguments[i]];}return result;},toQueryString:function(){return Hash.toQueryString(this);},inspect:function(){return'#<Hash:{'+this.map(function(pair){return pair.map(Object.inspect).join(': ');}).join(', ')+'}>';}});(function Baze_closure(){if(typeof Baze!=="undefined")return;var POSTBACK_URL=window.location.href;var initialized=false;var _createLoadingPanel=function _createLoadingPanel(){var lp=document.createElement("div");var img=document.createElement("img");lp.id='BazeLoadingPanel';lp.style.top='50%';lp.style.marginTop='-50px';lp.style.left='50%';lp.style.marginLeft='-120px';lp.style.height='100px';lp.style.width='240px';lp.style.borderWidth='1px';lp.style.borderStyle='solid';lp.style.borderColor='#AAAAAA';lp.style.backgroundColor='white';lp.style.textAlign='center';lp.className='cool';lp.innerHTML='<br /><br />Carregando...<br /><br/>';img.src=location.protocol+'//'+SYSTEM_SITE_ROOT+'library/images/loading.gif';lp.appendChild(img);lp.style.display='none';lp=document.body.appendChild(lp);return lp;};var _showLoading=function _showLoading(){if(!Baze.loadingPanel){Baze.loadingPanel=_createLoadingPanel();}Baze.loadingPanel.style.display='block';};var _hideLoading=function _hideLoading(){this.loadingPanel.style.display='none';};base=Baze={_serverObjs:null,_commands:null,_requiredModules:[],dom:{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12},errorLog:[],_findServerObjects:function _findServerObjects(node,collection){if(node.attributes["runat"]&&node.attributes["runat"].nodeValue=="server"&&node.attributes["phpclass"]){var phpClass=node.getAttribute("phpclass");var obj=Component.factory(phpClass,node);if(!obj){Baze.raise("Constructor for component "+phpClass+" not found.(Baze findServerObjects)",new Error());return;}obj.onPropertyChange.addListener(ClientViewState.objectChanged.bind(ClientViewState));if(Baze.isContainer(obj)){obj.onChildAdd.addListener(ClientViewState.objectChanged.bind(ClientViewState));obj.onChildRemove.addListener(ClientViewState.objectChanged.bind(ClientViewState));}collection.add(obj.getId(),obj);}if(node.hasChildNodes()){for(var i=0;i<node.childNodes.length;i++){if(node.childNodes[i].nodeType==Baze.dom.ELEMENT_NODE){this._findServerObjects(node.childNodes[i],collection);}}}},initialize:function initialize(){if(initialized){return;}console.info("Initializing Baze");var lang=(typeof CURRENT_LANG!="undefined"?CURRENT_LANG:"pt-br");Baze.require("i18n."+lang);Baze.require("system.collections.Collection");if(this._serverObjs===null)this._serverObjs=new Collection();if(this._serverObjs===null)this._commands=new Collection();Baze.require("system.viewState.ClientViewState");Baze.require("system.Environment");Baze.require("system.Postback");this.env=this.environment=new Environment();this.loadingPanel=_createLoadingPanel();Ajax.Responders.register({onCreate:function(){},onException:function(xhr,e){Baze.raise(e.message,xhr);},onComplete:function(){}});this.initializing=true;this._findServerObjects(document.documentElement,Baze._serverObjs);this.initializing=false;initialized=true;},onLoadComponents:function onLoadComponents(){},require:function require(path,options){var opt={asynchronous:false,forceRetry:false,onSuccess:function(){},onFailure:function(){}};for(var o in options)opt[o]=options[o];if(typeof Baze._requiredModules[path]!=="undefined"&&(Baze._requiredModules[path]==true||opt.forceRetry)){opt.onSuccess();return;}Baze._requiredModules[path]=false;var url='http://'+SYSTEM_SITE_ROOT+'library/js/'+path.replace(/\./g,'/')+'.js';function evalAndFeedback(xhr){try{eval(xhr.responseText);if(Baze._requiredModules[path])opt.onSuccess();}catch(ex){Baze.raise("Erro executando javascript do m�dulo "+path,ex,{xhr:reqAjax});}}var reqAjax=new Ajax.Request(url,{asynchronous:opt.asynchronous,onException:function(req,ex){Baze.raise("Erro requerindo o m�dulo "+path,ex);},onSuccess:evalAndFeedback,onFailure:opt.onFailure});},provide:function provide(path){Baze._requiredModules[path]=true;},getServerObjects:function getServerObjects(){return Baze._serverObjs;},addComponent:function addComponent(comp){comp.onPropertyChange.addListener(ClientViewState.objectChanged.bind(ClientViewState));if(Baze.isContainer(comp)){comp.onChildAdd.addListener(ClientViewState.objectChanged.bind(ClientViewState));comp.onChildRemove.addListener(ClientViewState.objectChanged.bind(ClientViewState));}if(!Baze.initializing)ClientViewState.addNewObject(comp);return Baze._serverObjs.add(comp.getId(),comp);},getComponentById:function getComponentById(id){return Baze._serverObjs.get(id);},removeComponent:function removeServerObjeect(id){var comp=Baze._serverObjs.remove(id);var node=null;if(comp===false){return false;}if((node=comp.realElement)!=false){var parentEl=node.parentNode;parentEl.removeChild(comp.realElement);}ClientViewState.addRemovedObject(comp);return true;},doPostBack:function doPostBack(e,args){this.initialize();_showLoading();if(!e)e=window.event;if(e.type=="submit"){Baze.require("web.form.Form");Baze.submitFiles(args.targetForm);}var pb=new Postback(POSTBACK_URL);window.lastPostBack=pb;var clientMessage="<?xml version=\"1.0\" encoding=\"UTF-8\"?><messages>";clientMessage+=ClientViewState.getEventMessage(e);clientMessage+=ClientViewState.getSyncMessage();clientMessage+="</messages>";pb.onReceiveMessage.addListener(_hideLoading.bind(this));pb.send(clientMessage);if(typeof args.preventDefault!='undefined'&&args.preventDefault){if(typeof e.preventDefault!='undefined')e.preventDefault();else e.returnValue=false;return false;}return true;},synchronize:function synchronize(){this.initialize();_showLoading();var pb=new Postback(POSTBACK_URL);window.lastPostBack=pb;var clientMessage="<?xml version=\"1.0\" encoding=\"UTF-8\"?><messages>";clientMessage+=ClientViewState.getSyncMessage();clientMessage+="</messages>";pb.onReceiveMessage.addListener(_hideLoading.bind(this));pb.send(clientMessage);},addEventListener:function addEventListener(object,event,func){Event.observe(object,event,func);},findFileUploads:function findFileUploads(f){var fileUploads=[];var results=f.getElementsByTagName("input");for(var i=0;i<results.length;i++){if(results[i].type=='file'){fileUploads[fileUploads.length]=results[i];}}return fileUploads;},submitFiles:function submitFiles(f){var upFields=Baze.findFileUploads(f);var iframe;if(upFields.length===0){return;}for(var i=0;i<upFields.length;i++){if(upFields[i].name!=upFields[i].id){var hid=document.createElement("input");hid.type="hidden";hid.name=upFields[i].name+"ID";hid.value=upFields[i].id;f.appendChild(hid);}}if(typeof this.submitIframe==="undefined"){iframe=window.open("","_submitIframe",'toolbar=0,location=0,statusbar=0,menubar=0,width=500,height=500,left = 262,top = 134');iframe.id="_submitIframe";iframe.name="_submitIframe";}else{iframe=this.submitIframe;}var oldTarget=f.target;f.target="_submitIframe";f.submit();f.target=oldTarget;iframe.loaded=false;iframe.onload="alert('submit finished. ' + window.location.href); window.loaded = true;";var maxTime=3000;var elapsedTime=0;while(!iframe.loaded&&elapsedTime<maxTime){wait(500);elapsedTime+=500;}this.submitIframe=iframe;return iframe.loaded;},raise:function raise(message,exception,extraInfo){var canImakeDebuggerStopHere="yes";var msg=message;if(exception&&typeof exception.message!="undefined")msg+=': '+exception.message;console.error(msg);console.trace();Baze.errorLog.push({message:message,exception:exception,info:extraInfo});},getCommand:function getCommand(id){var cmd=this._commands.get(id);if(!cmd)Baze.raise('O commando '+id+' nao existe ou nao foi registrado');return cmd;},registerCommand:function Baze_registerCommand(command){if(typeof this._commands=="undefined"||this._commands==null)this._commands=new Collection();this._commands.add(command.getId(),command);},unregisterCommand:function Baze_unregisterCommand(command){if(typeof command=="object"){if(!(command instanceof Baze.Command))Baze.raise("",new Error("Baze.unregisterCommand expects an Baze.Command or string as only parameter, "+(typeof command)+" given."));else command=command.getId();}this._commands.remove(command);},isComponent:function isComponet(object){return(typeof object.isComponent=="boolean"&&object.isComponent==true);},isContainer:function isContainer(object){return(typeof object.isContainer=="boolean"&&object.isContainer==true);},isVisualComponent:function isVisualComponet(object){return(typeof object.isVisualComponent=="boolean"&&object.isVisualComponent==true);}};$C=Baze.getComponentById;if(window.addEventListener){window.addEventListener('DOMContentLoaded',Baze.initialize.bind(Baze),false);}else if(window.attachEvent){window.attachEvent('onload',Baze.initialize.bind(Baze));}})();if(typeof Baze!=='undefined'){Baze.provide("system.lang");}is_array=function(obj){if(obj&&obj.constructor&&obj.constructor.toString().indexOf('Array')>-1){return true;}else{return YAHOO.lang.isObject(obj)&&obj.constructor==Array;}};is_boolean=function(obj){return typeof obj=='boolean';};is_function=function(obj){return typeof obj=='function';};is_null=function(obj){return obj===null;};is_number=function(obj){return typeof obj=='number'&&isFinite(obj);};is_object=function(obj){return obj&&(typeof obj=='object'||YAHOO.lang.isFunction(obj));};is_string=function(obj){return typeof obj=='string';},is_undefined=function(obj){return typeof obj=='undefined';};isset=function(obj,evaluate){if(typeof evaluate!=='undefined'){if(!is_string(obj))return false;eval('var set = (typeof '+obj.toString()+' !== "undefined");');return set;}else return typeof obj!=='undefined';};is_a:function is_a(obj,class_name){if(typeof obj=="object"&&typeof constructor=="string"){return(typeof obj.constructor=='function'&&obj.constructor.name==class_name);}throw new Wro;}if(typeof Baze!=='undefined'){Baze.provide("i18n.pt-br");}messages={lang:"pt-br"};messages.SERVER_ERROR="Erro no servidor";if(typeof Baze!=='undefined'){Baze.provide("system.collections.Collection");}Collection=function Collection(){this.index={};this.backIndex=[];this.values=[];};(function Collection_closure(){function compact(){this.backIndex=this.backIndex.compact();this.values=this.values.compact();for(var i=0;i<this.backIndex.length;i++){this.index[this.backIndex[i]]=i;}}Object.extend(Collection.prototype,{add:function Collection_add(key,value){if(this.index[key]!==undefined){return false;}if(typeof key!=="string"&&typeof key!=="numer"){Baze.raise("Error in Collection::add",new Error("The key value must be a string or a number"));return false;}this.index[key]=this.values.length;this.backIndex[this.values.length]=key;this.values.push(value);return true;},count:function Collection_count(){return this.values.length;},get:function Collection_get(key){if(typeof key=="number"){return this.values[key];}else{if(this.index[key]==undefined){return null;}return this.values[this.index[key]];}},getValues:function Collection_getValues(){var results=[];for(var i=0;i<this.values.length;i++){results.push(this.values[i]);}return results;},remove:function Collection_remove(key){var bak;if(typeof key=="number"){if(this.values[key]===undefined){return false;}bak=this.values[key];delete this.values[key];delete this.index[this.backIndex[key]];delete this.backIndex[key];compact.apply(this);}else if(typeof key=="string"){if(this.index[key]===undefined){return false;}bak=this.values[this.index[key]];delete this.values[this.index[key]];delete this.backIndex[this.index[key]];delete this.index[key];compact.apply(this);}else{Baze.raise("",new Error("Collection.remove expects a number or string as only parameter, "+(typeof key)+" given."));return null;}return bak;},removeAll:function Collection_removeAll(){this.index={};this.backIndex=[];this.values=[];}});})();if(typeof Baze!="undefined"){Baze.provide("system.Event");}Baze.Event=function Event(){this.listeners=[];};Object.extend(Baze.Event.prototype,{listeners:null,addListener:function(fn){if(typeof fn!=="function"){return null;}var ind=this.listeners.indexOf(fn);if(ind==-1)this.listeners.push(fn);},removeListener:function(fn){var ind=this.listeners.indexOf(fn);if(ind==-1)delete this.listeners[ind];},raise:function(obj,args){for(var i=0;i<this.listeners.length;i++){this.listeners[i](obj,args);}}});if(typeof Baze!=='undefined'){Baze.provide("system.viewState.Change");}ChangeType={PROPERTY_CHANGED:1,CHILD_ADDED:2,CHILD_REMOVED:3};Change=function Change(type,data){this.type=type;for(var v in data){this[v]=data[v];}};Object.extend(Change.prototype,{type:null,getXML:function getXML(){var str="";switch(this.type){case ChangeType.CHILD_ADDED:str+='<change type="childAdded" childId="'+this.child.get("id")+'" />';break;case ChangeType.CHILD_REMOVED:str='<change type="childRemoved" childId="'+this.child.get("id")+'" />';break;case ChangeType.PROPERTY_CHANGED:var propType="";if(this.newValue==null)this.newValue="";if(typeof this.newValue=="object"&&this.newValue.isArray()){propType="array";}else{propType=typeof this.newValue;}str='<change type="propertyChanged"'+' propertyName="'+this.propertyName+'"'+' propertyType="'+propType+'">'+'<![CDATA['+(propType=="array"?this.newValue.inspect():this.newValue.toString())+']]></change>';}return str;},getId:function(){switch(this.type){case ChangeType.PROPERTY_CHANGED:return"PropChange_"+this.propertyName;case ChangeType.CHILD_ADDED:return"ChildAddOrRemove_"+this.child.getId();case ChangeType.CHILD_REMOVED:return"ChildAddOrRemove_"+this.child.getId();}},isMirror:function Change_isMirror(chg){switch(this.type){case ChangeType.PROPERTY_CHANGED:if(chg.type==ChangeType.PROPERTY_CHANGED&&this.newValue==chg.oldValue&&this.oldValue==chg.newValue){return true;}break;case ChangeType.CHILD_ADDED:if(chg.type==ChangeType.CHILD_REMOVED&&chg.child.getId()==this.child.getId()){return true;}break;case ChangeType.CHILD_REMOVED:if(chg.type==ChangeType.CHILD_ADDED&&chg.child.getId()==this.child.getId()){return true;}break;}return false;},mergeWith:function Change_mergeWith(chg){if(this.type!==ChangeType.PROPERTY_CHANGED){return null;}if(this.type!==chg.type){Baze.raise("Different types of changes can not be merged",new Error());return null;}this.newValue=chg.newValue;}});if(typeof Baze!="undefined"){Baze.provide("system.viewState.ClientViewState");Baze.require("system.collections.Collection");Baze.require("system.viewState.Change");}(function ClientViewState_closure(){if(typeof ClientViewState!=='undefined')return;var _cache={neo:new Collection(),deleted:new Collection(),modified:new Collection()};ClientViewState={getCache:function ClientViewState_getCache(){return _cache;},addNewObject:function ClientViewState_addNewObject(obj){_cache.neo.add(obj.getId(),obj);},addRemovedObject:function ClientViewState_addRemovedObject(obj){_cache.deleted.add(obj.getId(),obj);},updateComponents:function updateComponents(objects){var object,objectId,objectChanges;var comp,change,cType;for(var i=0;i<objects.length;i++){object=objects.item(i);objectId=object.getAttribute('id');objectChanges=object.getElementsByTagName('change');comp=Baze.getComponentById(objectId);if(!comp){Baze.raise("Erro atualizando componentes",new Error("Component with id "+objectId+" could not be found."));continue;}for(var j=0;j<objectChanges.length;j++){change=objectChanges.item(j);cType=change.getAttribute('type');switch(Number(cType)){case ChangeType.PROPERTY_CHANGED:var propertyName=change.getAttribute('propertyName');var newValue=change.textContent||change.text;if(newValue)comp.set(propertyName,newValue);else comp.set(propertyName,"");break;case ChangeType.CHILD_ADDED:var childObj=Baze.getComponentById(change.getAttribute('childId'));if(!childObj){Baze.raise("",new Error("Child addition error. Object with id ("+change.getAttribute('childId')+") not found"));return;}comp.addChild(childObj);break;case ChangeType.CHILD_REMOVED:comp.removeChild(change.getAttribute('childId'));break;}}if(_cache.modified.get(objectId))_cache.modified.get(objectId).changes.removeAll()}},createComponents:function createComponents(objects){for(var i=0;i<objects.length;i++){var object=objects.item(i);var objectClass=object.getAttribute('class');var objectProperties=object.getElementsByTagName('property');var comp=Component.factory(objectClass);if(!comp){Baze.raise("",new Error(objectClass+" component could not be instantiated"));return;}comp.set("id",object.getAttribute('id'));var property,pName,pValue;for(var j=0;j<objectProperties.length;j++){property=objectProperties.item(j);pName=property.getAttribute('name');pValue=property.textContent||property.text;if(property.getAttribute('eval')=="1"){eval('var ___ = '+pValue);comp.set(pName,___);}else comp.set(pName,pValue);}Baze.addComponent(comp);}},removeComponents:function removeComponents(objects){for(var i=0;i<objects.length;i++){var id=false;if(!(id=objects.item(i).getAttribute("id"))){alert("O servidor retornou uma responsta inválida");Baze.raise("",new Error("Missing id for removed object."));return;}Baze.removeComponent(id);}},getEventMessage:function ClientViewState_getEventMessage(evt){if(!evt){Baze.raise("",new Error("Event object is required to build event messages."));return null;}var eventName=evt.type;var argumentsXml="";if(evt.srcElement){evt.currentTarget=evt.srcElement;}var target=evt.currentTarget;for(var v in evt){if(v!="type"&&!v.isUpperCased()&&typeof evt[v]!='function'&&typeof evt[v]!='object'){argumentsXml+='\n\t\t<argument>'+'<name>'+v+'</name>'+'<value>'+evt[v]+'</value>'+'</argument>';}}if(this.eventName=='submit'){var targetElem=evt.currentTarget;while(targetElem!==null&&targetElem.tagName!='form'){targetElem=targetElem.parentNode;}if(targetElem!==null){target=targetElem;}}else{while(target.parentNode.id&&target.attributes.phpclass===null){target=evt.target.parentNode;}}return'<clientMessage type="Event">'+'<content>'+'<event>'+eventName+'</event>'+'<target>'+target.id+'</target>'+'<arguments>'+argumentsXml+'</arguments>'+'</content>'+'</clientMessage>';},getSyncMessage:function ClientViewState_getSyncMessage(){var objArr=null;var msg='<clientMessage type="SyncMessage">'+'<objects>';var somethingToSend=false;msg+='<newObjects>';var neoArr=_cache.neo.values;if(neoArr.length)somethingToSend=true;for(var i=0;i<neoArr.length;i++){msg+=neoArr[i].getXML();}msg+='</newObjects>';msg+='<modifiedObjects>';var modArr=_cache.modified.values;for(i=0;i<modArr.length;i++){if(modArr[i].changes.values.length>0){somethingToSend=true;msg+='<object id="'+modArr[i].realObject.getId()+'">';msg+='<changes>';for(var j=0;j<modArr[i].changes.values.length;j++){msg+=modArr[i].changes.values[j].getXML();}msg+='</changes>';msg+='</object>';}}msg+='</modifiedObjects>';msg+='<removedObjects>';var delArr=_cache.deleted.values;if(delArr.length)somethingToSend=true;for(i=0;i<delArr.length;i++){msg+='<object id="'+delArr[i].getId()+'" />';}msg+='</removedObjects>';msg+='</objects>'+'</clientMessage>';if(somethingToSend)return msg;else return"";},objectChanged:function ClientViewState_objectChanged(obj,args){var chg=null;if(!obj){Baze.raise("",new Error("Object argument missing."));return;}if(!args){Baze.raise("",new Error("ObjectChanged function expects to receive 2 arguments. One given."));return null;}switch(args.changeType){case ChangeType.PROPERTY_CHANGED:chg=new Change(ChangeType.PROPERTY_CHANGED,{propertyName:args.propertyName,oldValue:args.oldValue,newValue:obj.get(args.propertyName)});break;case ChangeType.CHILD_ADDED:chg=new Change(ChangeType.CHILD_ADDED,{child:args.child});break;case ChangeType.CHILD_REMOVED:chg=new Change(ChangeType.CHILD_REMOVED,{child:args.child});break;default:Baze.raise("",new Error("Change type '"+args.changeType+"' is not supported"));return null;}var chgObj=null;if(!_cache.modified.get(obj.getId())){_cache.modified.add(obj.getId(),{realObject:obj,changes:new Collection()});chgObj=_cache.modified.get(obj.getId());}else{chgObj=_cache.modified.get(obj.getId());}var change_=chgObj.changes.get(chg.getId());if(change_!=null){if(change_.isMirror(chg)){chgObj.changes.remove(chg.getId());}else{change_.mergeWith(chg);}}else{chgObj.changes.add(chg.getId(),chg);}},setSynchronized:function ClientViewState_setSynchronized(){_cache.neo.removeAll();_cache.modified.removeAll();_cache.deleted.removeAll();}}})();if(typeof Baze!="undefined"){Baze.provide("system.Environment");}var getBrowserInfo=function getBrowserInfo(){function trim(str){return str.replace(/^\s+|\s+$/gi,"").replace(/\s{2,}/gi," ");}function detectRenderEngine(){var presto=window.opera;var gecko=navigator.product=='Gecko';var mariner=document.layers&&navigator.mimeTypes['*'];var khtml=navigator.vendor=='KDE'||(document.childNodes&&!document.all&&!navigator.taintEnabled);var icab=window.ScriptEngine&&ScriptEngine().indexOf('InScript')+1;var trident=window.ActiveXObject;if(presto){this.renderEngine="Presto";}else if(gecko){this.renderEngine="Gecko";}else if(mariner){this.renderEngine="Mariner";}else if(khtml){this.renderEngine="KHTML";}else if(icab){this.renderEngine="iCab";}else if(trident){this.renderEngine="Trident";}}function detectNameAndVersion(){var ua=navigator.userAgent;var uaLen=ua.length;var i,j,ind;var preparens="";var parenthesized="";var postparens="";ind=ua.indexOf("(");if(ind>=0){preparens=trim(ua.substring(0,ind));parenthesized=ua.substring(ind+1,uaLen);j=parenthesized.indexOf(")");if(j>=0){postparens=trim((parenthesized.substring(j+1,uaLen)).replace(' ',';'));parenthesized=parenthesized.substring(0,j)+'; '+postparens;}}else{preparens=ua;}var browVer=preparens;var tokens=parenthesized.split(";");var token="";for(i=0;i<tokens.length;i++){token=trim(tokens[i]);if(token=="compatible"){}else if(token.indexOf("MSIE")>=0||token.indexOf("Gecko")>=0||token.indexOf("Opera")>=0||token.indexOf("AppleWebKit")>=0||token.indexOf("Konqueror")>=0||token.indexOf("Safari")>=0||token.indexOf("OmniWeb")>=0||token.indexOf("Netscape")>=0||token.indexOf("SeaMonkey")>=0||token.indexOf("Firefox")>=0){browVer=token;}if((token.indexOf("X11")>=0)||(token.indexOf("SunOS")>=0)||(token.indexOf("Linux")>=0)){this.platform="Unix";}else if(token.indexOf("Win")>=0){this.platform=token;}else if((token.indexOf("Mac")>=0)||(token.indexOf("PPC")>=0)){this.platform=token;}}var msieIndex=browVer.indexOf("MSIE");if(msieIndex>=0){browVer=browVer.substring(msieIndex,browVer.length);}var leftover="";if(browVer.substring(0,"Mozilla".length)=="Mozilla"){this.name="Netscape";leftover=browVer.substring("Mozilla".length+1,browVer.length);}else if(browVer.substring(0,"Lynx".length)=="Lynx"){this.name="Lynx";leftover=browVer.substring("Lynx".length+1,browVer.length);}else if(browVer.substring(0,"MSIE".length)=="MSIE"){this.name="IE";leftover=browVer.substring("MSIE".length+1,browVer.length);}else if(browVer.substring(0,"Microsoft Internet Explorer".length)=="Microsoft Internet Explorer"){this.name="IE";leftover=browVer.substring("Microsoft Internet Explorer".length+1,browVer.length);}else if(browVer.substring(0,"Opera".length)=="Opera"){this.name="Opera";leftover=browVer.substring("Opera".length+1,browVer.length);}else if(navigator.userAgent.indexOf("Firefox")>=0){this.name="Firefox";leftover=browVer.substring("Firefox".length+1,browVer.length);}else if(browVer.substring(0,"SeaMonkey".length)=="SeaMonkey"){this.name="SeaMonkey";leftover=browVer.substring("SeaMonkey".length+1,browVer.length);}else if(browVer.substring(0,"Netscape".length)=="Netscape"){this.name="Netscape6+";leftover=browVer.substring("Netscape".length+1,browVer.length);}else if(browVer.substring(0,"AppleWebKit".length)=="AppleWebKit"){this.name="(Safari-based)";leftover=browVer.substring("AppleWebKit".length+1,browVer.length);}else if(browVer.substring(0,"Safari".length)=="Safari"){this.name="Safari";leftover=browVer.substring("Safari".length+1,browVer.length);}else if(browVer.substring(0,"Konqueror".length)=="Konqueror"){this.name="Konqueror";leftover=browVer.substring("Konqueror".length+1,browVer.length);}else if(browVer.substring(0,"OmniWeb".length)=="OmniWeb"){this.name="OmniWeb";leftover=browVer.substring("OmniWeb".length+1,browVer.length);}else if(browVer.substring(0,"Gecko".length)=="Gecko"){this.name="(Gecko-based)";leftover=browVer.substring("Gecko".length+1,browVer.length);}leftover=trim(leftover);ind=leftover.indexOf(" ");if(i>=0){this.version=trim(leftover.substring(0,i));}else{this.version=trim(leftover);}j=this.version.indexOf(".");if(j>=0){this.majorver=this.version.substring(0,j);this.minorver=this.version.substring(j+1,this.version.length);}else{this.majorver=this.version;}}var info={name:null,platform:null,renderEngine:null,version:null,majorver:null,minorver:null};detectNameAndVersion.apply(info);detectRenderEngine.apply(info);return info;};Environment=function Environment(){var myWidth=0,myHeight=0;if(typeof(window.innerWidth)=='number'){this.screen.getInnerWidth=function(){return window.innerWidth;};this.screen.getInnerHeight=function(){return window.innerHeight;};}else if(typeof document.body.clientWidth!='undefined'){this.screen.getInnerWidth=function(){return document.body.clientWidth;};this.screen.getInnerHeight=function(){return document.body.clientHeight;};}else if(typeof document.documentElement.clientWidth!='undefined'){this.screen.getInnerWidth=function(){return document.documentElement.clientWidth;};this.screen.getInnerHeight=function(){return document.documentElement.clientHeight;};}var scrOfX=0,scrOfY=0;if(typeof(window.pageYOffset)=='number'){this.body.getScrollTop=function(){return window.pageYOffset;};this.body.getScrollLeft=function(){return window.pageXOffset;};}else if(typeof document.body.scrollLeft!='undefined'){this.body.getScrollTop=function(){return document.body.scrollTop;};this.body.getScrollLeft=function(){return document.body.scrollLeft;};}else if(typeof document.documentElement.scrollLeft!='undefined'){this.body.getScrollTop=function(){return document.documentElement.scrollTop;};this.body.getScrollLeft=function(){return document.documentElement.scrollLeft;};}};Object.extend(Environment.prototype,{browser:getBrowserInfo(),screen:{},body:{}});if(typeof Baze!="undefined"){Baze.provide("system.Postback");Baze.require("system.viewState.ClientViewState");Baze.require("system.Event");}Postback=function Postback(url,urlArgs,method){this.url=url;this.urlArgs=urlArgs;this.method=method;this.onSendMessage=new Baze.Event();this.onReceiveMessage=new Baze.Event();this.onBeforeProcessMessage=new Baze.Event();this.onAfterProcessMessage=new Baze.Event();};Object.extend(Postback.prototype,{commands:{BeforeCreateObjects:[],BeforeModifyObjects:[],BeforeDeleteObjects:[],OnMessageEnd:[]},receiveServerMessage:function receiveServerMessage(xhr,xjson){this.onReceiveMessage.raise();var xmlDoc=xhr.responseXML;if(xmlDoc===null||xmlDoc.firstChild==null){alert("O servidor n�o respondeu � requisi��o");if(xhr.responseText){Baze.raise("falha no postback",new Error("AJAX request error"),{error:1,message:xhr.responseText});console.group("Response");console.log(xhr.responseText);console.groupEnd();console.groupEnd();}return false;}else if(xmlDoc.firstChild!=null&&xmlDoc.firstChild.tagName=="parsererror"){alert(xmlDoc.firstChild.firstChild.nodeValue);Baze.raise("falha no postback",new Error(),{error:2,message:xmlDoc.firstChild.firstChild.nodeValue});console.group("Response");console.log(xhr.responseText);console.groupEnd();console.groupEnd();return false;}console.group("Response");console.log(xhr.responseText);console.groupEnd();console.groupEnd();this.onBeforeProcessMessage.raise();this.loadCommands(xmlDoc);this.processMessage(xmlDoc);ClientViewState.setSynchronized();this.onAfterProcessMessage.raise();return true;},loadCommands:function loadCommands(xmlDoc){commands=xmlDoc.getElementsByTagName('command');for(i=0;i<commands.length;i++){var act=commands[i].getAttribute("name");var executeOn=commands[i].getAttribute("executeon");var parmsNodes=commands[i].getElementsByTagName('param');var parms=[];for(j=0;j<parmsNodes.length;j++){var param=parmsNodes[j].getAttribute('name');var value=parmsNodes[j].textContent||parmsNodes[j].text;parms.push(value);}var cmd=Baze.getCommand(act);var commCall=cmd.prepare(parms);switch(Number(executeOn)){case Postback.MessageParsePhase.BeforeCreateObjects:this.commands.BeforeCreateObjects.push(commCall);break;case Postback.MessageParsePhase.BeforeModifyObjects:this.commands.BeforeModifyObjects.push(commCall);break;case Postback.MessageParsePhase.BeforeDeleteObjects:this.commands.BeforeDeleteObjects.push(commCall);break;case Postback.MessageParsePhase.OnMessageEnd:this.commands.OnMessageEnd.push(commCall);break;}}},processMessage:function processMessage(xmlDoc){for(var i=0;i<this.commands.BeforeDeleteObjects.length;i++)this.commands.BeforeDeleteObjects[i].run();objectsGroup=xmlDoc.getElementsByTagName("removedObjects");if(objectsGroup.length>0){objects=objectsGroup.item(0).getElementsByTagName("object");ClientViewState.removeComponents(objects);}for(var i=0;i<this.commands.BeforeCreateObjects.length;i++)this.commands.BeforeCreateObjects[i].run();var objectsGroup=xmlDoc.getElementsByTagName("newObjects");if(objectsGroup.length>0){var objects=objectsGroup.item(0).getElementsByTagName("object");ClientViewState.createComponents(objects);}for(var i=0;i<this.commands.BeforeModifyObjects.length;i++)this.commands.BeforeModifyObjects[i].run();objectsGroup=xmlDoc.getElementsByTagName("modifiedObjects");if(objectsGroup.length>0){objects=objectsGroup.item(0).getElementsByTagName("object");ClientViewState.updateComponents(objects);}for(var i=0;i<this.commands.OnMessageEnd.length;i++)this.commands.OnMessageEnd[i].run();},send:function send(message){this.myAjax=new Ajax.Request(this.url,{postBody:"__clientMessage="+encodeURI(message)+(this.urlArgs?"&"+this.urlArgs:""),requestHeaders:["Content-Type","application/x-www-form-urlencoded"],onException:function(xhr,ex){Baze.raise("Postback exception",ex,{xhr:xhr});},onComplete:this.receiveServerMessage.bind(this)});console.group("NeoBaze postback");console.group("Post");console.log(message);console.groupEnd();this.onSendMessage.raise();}});Postback.PostbackEventType={OnSendMessage:500,OnReceiveMessage:501,OnBeforeProcessMessage:502,OnAfterProcessMessage:503};Postback.MessageParsePhase={BeforeCreateObjects:701,BeforeModifyObjects:702,BeforeDeleteObjects:703,OnMessageEnd:704};if(typeof Baze!="undefined"){Baze.provide("system.util");}wait=function wait(millis){date=new Date();do{var curDate=new Date();}while(curDate-date<millis);};uid=function uid(prefix){var id;if(!prefix)prefix="";do{id=prefix+Math.round(Math.random()*10000000000).toString();}while($(id)!=null)return id;};if(typeof Baze!="undefined"){Baze.provide("system.commands.Command");}var PreparedCommand=function PreparedCommand(cmd,args){this.command=cmd;if(typeof args!=='undefined')this.arguments=args;};Object.extend(PreparedCommand.prototype,{command:null,arguments:[],run:function run(){if(this.arguments){this.command.run(this.arguments);}else{this.command.run();}}});function checkType(obj,type){if(typeof type=="object"&&type.isArray()){for(var i=0;i<type.length;i++){if(checkType(obj,type[i])){return true;}}return false;}if(typeof type=="string")return(typeof obj==type);if(typeof type=="object")return(obj instanceof type);}Baze.Command=function Command(options){this.checkArgumentTypes=true;for(var v in options)this[v]=options[v];};Object.extend(Baze.Command.prototype,{action:null,argumentTypes:[],checkArgumentTypes:true,executeOn:null,id:null,name:null,getId:function(){return this.id;},run:function Command_run(args){if(this.checkArgumentTypes){var len=this.argumentTypes.length;for(var i=0;i<len;i++){if(!checkType(args[i],this.argumentTypes[i])){Baze.raise("Erro executando commando "+this.id+'. ',new Error("Argument "+i+" should be "+(typeof this.argumentTypes[i])+", "+(typeof arguments[i])+'('+arguments[i]+') given.'));return;}}}return this.action.apply(this,args);},prepare:function prepare(args){if(this.checkArgumentTypes){var len=this.argumentTypes.length;for(var i=0;i<len;i++){if(!checkType(args[i],this.argumentTypes[i])){Baze.raise("Erro executando commando "+this.id+'. ',new Error("Argument "+i+" should be "+(typeof this.argumentTypes[i])+", "+(typeof arguments[i])+'('+arguments[i]+') given.'));return;}}}return new PreparedCommand(this,args);}});if(typeof Baze!=='undefined'){Baze.provide("system.commands.common");Baze.require("system.commands.Command");}Baze.CommandType={Redirect:"Redirect",CallJSFunction:"CallFunction",EmptyCommand:"EmptyCommand"};Baze.registerCommand(new Baze.Command({id:Baze.CommandType.Redirect,name:Baze.CommandType.Redirect,action:function Redirect(url){window.location.href=url;},argumentTypes:["string"]}));Baze.registerCommand(new Baze.Command({id:Baze.CommandType.CallJSFunction,name:Baze.CommandType.CallJSFunction,action:function(name,args){eval(name+'('+args+')');},argumentTypes:["string","string"]}));Baze.registerCommand(new Baze.Command({id:Baze.CommandType.EmptyCommand,name:Baze.CommandType.EmptyCommand,action:function(){},argumentTypes:[],checkArgumentTypes:false}));